<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>User Profile</title>
    <link rel="stylesheet" href="/css/Style.css" />
    <script>
        function showUpdateField(fieldId) {
            document.getElementById(fieldId).style.display = 'block';
        }
    </script>
</head>
<body>
<header th:replace="~{commons/fragments::nav}"></header>
<div class="user-container">
    <h1>Profile details for <span th:text="${user.username}"></span></h1>
    <ul th:object="${user}">
        <li>
            <p th:text="'First Name: ' + *{firstName}"></p>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updateFirstName')">Change First Name</button>
            <div id="updateFirstName" class="hidden-form">
                <form th:action="@{/profile/update/firstName}" method="post">
                    <input type="text" name="firstName" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>
        <li>
            <p th:text="'Last Name: ' + *{lastName}"></p>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updateLastName')">Change Last Name</button>
            <div id="updateLastName" class="hidden-form">
                <form th:action="@{/profile/update/lastName}" method="post">
                    <input type="text" name="lastName" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>
        <li>
            <p th:text="'Email: ' + *{email}"></p>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updateEmail')">Change Email</button>
            <div id="updateEmail" class="hidden-form">
                <form th:action="@{/profile/update/email}" method="post">
                    <input type="email" name="email" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>
        <li>
            <p>Password: ********</p>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updatePassword')">Change Password</button>
            <div id="updatePassword" class="hidden-form">
                <form th:action="@{/profile/update/password}" method="post">
                    <input type="password" name="password" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>
        <li>
            <p>Profile Picture:</p>
            <img th:src="@{${user.photoURL}}" alt="Profile Picture" width="100" height="100"/>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updatePhotoURL')">Change Profile Picture</button>
            <div id="updatePhotoURL" class="hidden-form">
                <form th:action="@{/profile/update/photoURL}" method="post" enctype="multipart/form-data">
                    <input type="file" name="photoURL" accept="image/*" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>


        <li th:if="${isAdmin}">
            <p th:text="'Phone Number: ' + *{phoneNumber}"></p>
            <button type="button" class="btn btn-secondary" onclick="showUpdateField('updatePhoneNumber')">Change Phone Number</button>
            <div id="updatePhoneNumber" class="hidden-form">
                <form th:action="@{/profile/update/phoneNumber}" method="post">
                    <input type="text" name="phoneNumber" required/>
                    <button type="submit" class="btn">Update</button>
                </form>
            </div>
        </li>
        </li>


        //Todo Add other fields as necessary
<!--        <li>-->
<!--            <a href="/profile/posts" class="btn btn-secondary">All My Posts</a>-->
<!--        </li>-->
<!--        <li>-->
<!--            <a href="/profile/recently-viewed" class="btn btn-secondary">Recently Viewed Posts</a>-->
<!--        </li>-->
    </ul>
</div>
<footer th:replace="~{commons/fragments::footer}">

</footer>
</body>
</html>